<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Rosalind - anti-PD1 treatment for BC patients</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Rosalind</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/imkhoibui/rosalind"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../reading/paper.html">Reading comprehension</a></li><li class="breadcrumb-item"><a href="../reading/paper.html">anti-PD1 treatment for BC patients</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Rosalind</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rosalind_markdowns/1_10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1-10</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rosalind_markdowns/11_20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11-20</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rosalind_markdowns/21_30.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">21-30</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rosalind_markdowns/31_40.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">31-40</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rosalind_markdowns/41_50.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">41-50</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Reading comprehension</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reading/paper.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">anti-PD1 treatment for BC patients</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Sorting algorithms</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sorting/sort.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Insertion sorting</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#about-single-cell-rna-seq" id="toc-about-single-cell-rna-seq" class="nav-link active" data-scroll-target="#about-single-cell-rna-seq">About single-cell RNA-seq</a></li>
  <li><a href="#study-overview" id="toc-study-overview" class="nav-link" data-scroll-target="#study-overview">Study overview</a></li>
  <li><a href="#investigative-questions" id="toc-investigative-questions" class="nav-link" data-scroll-target="#investigative-questions">Investigative questions</a>
  <ul class="collapse">
  <li><a href="#what-information-to-gather-from-the-paper-to-re-analyze-the-paper-and-use-the-data-for-future-big-data-research-purposes" id="toc-what-information-to-gather-from-the-paper-to-re-analyze-the-paper-and-use-the-data-for-future-big-data-research-purposes" class="nav-link" data-scroll-target="#what-information-to-gather-from-the-paper-to-re-analyze-the-paper-and-use-the-data-for-future-big-data-research-purposes">What information to gather from the paper to re-analyze the paper and use the data for future big data research purposes</a></li>
  <li><a href="#can-you-provide-an-explanation-of-how-single-cell-rna-sequencing-experiments-were-specifically-designed-to-study-the-topic" id="toc-can-you-provide-an-explanation-of-how-single-cell-rna-sequencing-experiments-were-specifically-designed-to-study-the-topic" class="nav-link" data-scroll-target="#can-you-provide-an-explanation-of-how-single-cell-rna-sequencing-experiments-were-specifically-designed-to-study-the-topic">Can you provide an explanation of how single-cell RNA sequencing experiments were specifically designed to study the topic?</a></li>
  <li><a href="#from-the-paper-list-the-major-cell-types-and-their-marker-genes" id="toc-from-the-paper-list-the-major-cell-types-and-their-marker-genes" class="nav-link" data-scroll-target="#from-the-paper-list-the-major-cell-types-and-their-marker-genes">From the paper, list the major cell types and their marker genes</a></li>
  <li><a href="#from-the-paper-list-the-cell-subtypes" id="toc-from-the-paper-list-the-cell-subtypes" class="nav-link" data-scroll-target="#from-the-paper-list-the-cell-subtypes">From the paper, list the cell subtypes</a></li>
  <li><a href="#what-information-or-data-was-not-further-investigated-by-the-author-that-might-hold-potential-for-significant-findings" id="toc-what-information-or-data-was-not-further-investigated-by-the-author-that-might-hold-potential-for-significant-findings" class="nav-link" data-scroll-target="#what-information-or-data-was-not-further-investigated-by-the-author-that-might-hold-potential-for-significant-findings">What information or data was NOT further investigated by the author that might hold potential for significant findings?</a></li>
  <li><a href="#what-new-knowledge-or-insights-did-you-acquire-from-reading-this-paper-stated-in-your-own-words" id="toc-what-new-knowledge-or-insights-did-you-acquire-from-reading-this-paper-stated-in-your-own-words" class="nav-link" data-scroll-target="#what-new-knowledge-or-insights-did-you-acquire-from-reading-this-paper-stated-in-your-own-words">What new knowledge or insights did you acquire from reading this paper, stated in your own words?</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../reading/paper.html">Reading comprehension</a></li><li class="breadcrumb-item"><a href="../reading/paper.html">anti-PD1 treatment for BC patients</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">anti-PD1 treatment for BC patients</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>Full title:</strong> A single-cell map of intratumoral changes during anti-PD1 treatment of patients with breast cancer</p>
<p><strong>DOI:</strong> https://doi.org/10.1038/s41591-021-01323-8</p>
<section id="about-single-cell-rna-seq" class="level2">
<h2 class="anchored" data-anchor-id="about-single-cell-rna-seq">About single-cell RNA-seq</h2>
<p><strong>(WHAT) is single-cell RNA-seq?</strong></p>
<p>Single-cell RNA-seq is a method used to implement analysis in individual cells (in contrast with original bulk RNA-seq) in order to get a more thorough understanding of the cells in context of its microenvironment.</p>
<p><strong>(WHY) do single-cell RNA-seq?</strong></p>
<p>When performing traditional bulk RNA-seq, the challenges remains for scientist to dissect the details of the results. For example, are these data showing gene expression of all the tumorous cells, or is the it a compilation of healthy and malignant? Traditional technique average out all the information of mixture of cells, hence making it difficult to if we were to study a specific cell types among those.</p>
<p>Single-cell sequencing can identify different cell subtypes with the data, where many thousands of cells are processed at the same time. They can be then clustered to identify the types, and then used to further explore the targets.</p>
<p><strong>(HOW) is single-cell RNA-seq done?</strong></p>
<p>Single-cell RNA-seq consists of the following steps:</p>
<ol type="1">
<li><p>Cell isolation on ice</p></li>
<li><p>RNA reverse transcription</p></li>
<li><p>Library preparation</p></li>
<li><p>Sequencing</p></li>
<li><p>Preprocessing (Read alignment, normalization, PCA?)</p></li>
<li><p>Cell clustering and subtype clustering</p></li>
</ol>
</section>
<section id="study-overview" class="level2">
<h2 class="anchored" data-anchor-id="study-overview">Study overview</h2>
<p>This paper investigates whether the use of anti-PD1 (one dose of pembrolizumab) on breast cancer patients was able to alter biomarkers related to intratumoral immunity and proliferation.</p>
<p>Basic steps are below:</p>
<p><img src="../data/ref/scRNA.png" class="img-fluid"></p>
</section>
<section id="investigative-questions" class="level2">
<h2 class="anchored" data-anchor-id="investigative-questions">Investigative questions</h2>
<section id="what-information-to-gather-from-the-paper-to-re-analyze-the-paper-and-use-the-data-for-future-big-data-research-purposes" class="level3">
<h3 class="anchored" data-anchor-id="what-information-to-gather-from-the-paper-to-re-analyze-the-paper-and-use-the-data-for-future-big-data-research-purposes">What information to gather from the paper to re-analyze the paper and use the data for future big data research purposes</h3>
<p>Re-analyzing this paper requires:</p>
<p>Data:</p>
<ol type="1">
<li><p>Raw-sequencing reads of scRNA-seq, scTCR-seq and CITE-seq. The access to those data can be found at the European Genomephenome Archive (EGA) under data accession number <em>EGAD00001006608</em></p></li>
<li><p>gnomAD database is used to filter tumor exome-seq data for somatic mutations.</p></li>
</ol>
<p>Information:</p>
<ol type="1">
<li><p>Tools &amp; methods used: which softwares/tools were used in this experiment? What are the hyperparameters settings (if any).</p></li>
<li><p>The antibodies used in the study</p></li>
<li><p>Samples characteristics &amp; clinical data</p></li>
</ol>
</section>
<section id="can-you-provide-an-explanation-of-how-single-cell-rna-sequencing-experiments-were-specifically-designed-to-study-the-topic" class="level3">
<h3 class="anchored" data-anchor-id="can-you-provide-an-explanation-of-how-single-cell-rna-sequencing-experiments-were-specifically-designed-to-study-the-topic">Can you provide an explanation of how single-cell RNA sequencing experiments were specifically designed to study the topic?</h3>
<p>The sequencing experiments were designed as follow:</p>
<ol type="1">
<li><p>Biopsies were obtained pre-treatment and on-treatment and then subjected to single-cell disassociation on ice. The cells are then filtered after removal of red blood cells and number of living cells were determined using a LUNA cell counter.</p></li>
<li><p>Single-cell TCR-seq and 5’ gene expression profiling was performed with upto 5000 cells are loaded to the cartridge for each sample.</p></li>
<li><p>Performed subcluster T cells from pre- and on-treatment samples using the integration pipeline of Seurat.</p></li>
</ol>
</section>
<section id="from-the-paper-list-the-major-cell-types-and-their-marker-genes" class="level3">
<h3 class="anchored" data-anchor-id="from-the-paper-list-the-major-cell-types-and-their-marker-genes">From the paper, list the major cell types and their marker genes</h3>
<p>Major cell types:</p>
<ul>
<li><p>T cells have the marker genes: CD3D, CD3E, CD2</p></li>
<li><p>Fibroblast have the marker genes: COL1A1, DCN, C1R</p></li>
<li><p>Myeloid cells, their markers are: CLEC9A, XCR1, CD1C, CCR7, CCL17, CCL19 (cCDs) and CD1A, CD207 (Langerhans-like)</p></li>
<li><p>Cancer cells have the marker genes CD24, KRT19, SCGB2A2</p></li>
<li><p>B cells have the marker genes: CD79A, MZB1, MS4A1</p></li>
</ul>
</section>
<section id="from-the-paper-list-the-cell-subtypes" class="level3">
<h3 class="anchored" data-anchor-id="from-the-paper-list-the-cell-subtypes">From the paper, list the cell subtypes</h3>
<p>T cells have the following cell subtypes:</p>
<ul>
<li><p>CD4<sup>+</sup> and CD8<sup>+</sup> naive T cells (T<sub>N</sub>)</p></li>
<li><p>CD4<sup>+</sup> and CD8<sup>+</sup> experienced T cells (T<sub>EX</sub>), which the former were further split into type-1 helper (T<sub>H1</sub>) and follicular helper (T<sub>FH</sub>)</p></li>
<li><p>CD4<sup>+</sup> regulatory T cells (T<sub>REG</sub>)</p></li>
<li><p>CD8<sup>+</sup> effector/memory T cells (T<sub>EM</sub>)</p></li>
<li><p>CD8<sup>+</sup> resident-memory T cells (T<sub>RM</sub>)</p></li>
<li><p>CD8<sup>+</sup> activated effector/memory T cells (T<sub>EMRA</sub>)</p></li>
</ul>
<p><img src="../data/ref/t_cells.png" class="img-fluid"></p>
<p>Dendritic cells have the following cell subtypes:</p>
<ul>
<li><p>Conventional type 1 and 2 dendritic cells (cDC1, cDC2)</p></li>
<li><p>Plasmacytoid dendritic cells (pDC)</p></li>
<li><p>Langerhans-like dendritic cells (LanghDC)</p></li>
<li><p>Migratory dendritic cells (migDC)</p></li>
<li><p>AXL<sup>+</sup>SIGLEC6<sup>+</sup> dendritic cells (ASDC)</p></li>
</ul>
<p>Macrophages have the following subtypes:</p>
<ul>
<li><p>C3-C10 macrophages</p></li>
<li><p>C7_MT1G macrophages</p></li>
<li><p>Hypoxic C8_SLC2A1 macrophages</p></li>
</ul>
</section>
<section id="what-information-or-data-was-not-further-investigated-by-the-author-that-might-hold-potential-for-significant-findings" class="level3">
<h3 class="anchored" data-anchor-id="what-information-or-data-was-not-further-investigated-by-the-author-that-might-hold-potential-for-significant-findings">What information or data was NOT further investigated by the author that might hold potential for significant findings?</h3>
<p>From the paper, I think that we can investigate further on how tumor-associated macrophages influence the clinical benefits (or clonotype expansion) of said patients. From what I’ve learned, TAMs can suppress the activity of T cells, and perhaps they could interfere with T cells expansion. Hence, understanding this might give a bit light into why the expansion works on some patients and not for the rest.</p>
<p>Technically, I think after isolating, preprocessing and clustering the macrophages, we can perform pathway enrichment analysis or network analysis using deep learning methods.</p>
</section>
<section id="what-new-knowledge-or-insights-did-you-acquire-from-reading-this-paper-stated-in-your-own-words" class="level3">
<h3 class="anchored" data-anchor-id="what-new-knowledge-or-insights-did-you-acquire-from-reading-this-paper-stated-in-your-own-words">What new knowledge or insights did you acquire from reading this paper, stated in your own words?</h3>
<p>Here are the things that I have learned (a lot actually but these are the main things):</p>
<p><strong>(1) On various T-cell types:</strong></p>
<ul>
<li>Exhausion of T cell was induced by multiple checkpoint molecules (PD1, Tim3, Lag3, Tigit…). The blockage of just one ICB (in this case PD1), might be insufficient to gain clinical benefits. Therefore people would want to attempt to block multiple checkpoints, as this would benefit more, yet overdoing this might lead to disequilibrium, and therefore could even harm the body.</li>
</ul>
<p><strong>(2) Tumor formation and its battle with the immune system:</strong></p>
<p>From what I read, I’d like to simplify the process as below:</p>
<ul>
<li><p>Tumor is formed when cells undergo weird mutations, that could have been the products of oncogenes (these should be turned off after the embryonic phase but mutations turn them on again) -&gt; driving an uncontrollable cycle of the cell.</p></li>
<li><p>More and more nearby cells experience these mutations, and they form a tumor.</p></li>
<li><p>The immune system might have recognized already tumorous cells and tried to kill them, but unsuccesful attempts led to tumor formation.</p></li>
<li><p>According to <em>The hallmark of cancer</em>, tumor cells have ways to evade the immune system, one of which is utilizing the immune checkpoint to abstain the cytotoxic T cells from destroying it.</p></li>
<li><p>If they are successful in their own schemes -&gt; tumor won the immune system by recruiting them to assist them as well! (such as macrophages can be asked to avoid attacks from other T cells, or forming more blood vessels that aid the nutritional pathway to the cancer) and slowly becoming bigger and bigger.</p></li>
</ul>
<p><strong>(3)The thinking process of this study is very meticulous</strong></p>
<ul>
<li><p>I actually (in an attempt) tried to answer the question of “what can be further investiaged” by researching on what others are doing in the same topic. But no matter what new buzzwords or concepts I read about, it appears that this paper has done it. It also might be due to my lack of expertise, but everything ranging from GSEA to cell-cell interactions, the paper has done it, which is cool.</p></li>
<li><p>I tried to think of the process of this paper, from Result 1 to the end. It was incredible to me how they came up with the entire process, and how the results supports each other, and I got inspired to learn about this topic more.</p></li>
<li><p>There’s so many things I don’t know! (but eager to learn)</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>