<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Rosalind - 21-30</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Rosalind</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/imkhoibui/rosalind"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../rosalind_markdowns/1_10.html">Rosalind</a></li><li class="breadcrumb-item"><a href="../rosalind_markdowns/21_30.html">21-30</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Rosalind</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rosalind_markdowns/1_10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1-10</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rosalind_markdowns/11_20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11-20</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rosalind_markdowns/21_30.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">21-30</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rosalind_markdowns/31_40.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">31-40</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rosalind_markdowns/41_50.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">41-50</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Reading comprehension</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reading/paper.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">anti-PD1 treatment for BC patients</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Sorting algorithms</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sorting/sort.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Insertion sorting</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#locating-restriction-sites" id="toc-locating-restriction-sites" class="nav-link active" data-scroll-target="#locating-restriction-sites">21 Locating Restriction Sites</a></li>
  <li><a href="#rna-splicing" id="toc-rna-splicing" class="nav-link" data-scroll-target="#rna-splicing">22 RNA Splicing</a></li>
  <li><a href="#enumerating-k-mers-lexicographically" id="toc-enumerating-k-mers-lexicographically" class="nav-link" data-scroll-target="#enumerating-k-mers-lexicographically">23 Enumerating k-mers Lexicographically</a></li>
  <li><a href="#genome-assembly-shortest-superstring" id="toc-genome-assembly-shortest-superstring" class="nav-link" data-scroll-target="#genome-assembly-shortest-superstring">24 Genome assembly shortest superstring</a></li>
  <li><a href="#perfect-matchings" id="toc-perfect-matchings" class="nav-link" data-scroll-target="#perfect-matchings">25 Perfect Matchings</a></li>
  <li><a href="#introduction-to-random-strings" id="toc-introduction-to-random-strings" class="nav-link" data-scroll-target="#introduction-to-random-strings">26 Introduction to Random Strings</a></li>
  <li><a href="#finding-a-spliced-motif" id="toc-finding-a-spliced-motif" class="nav-link" data-scroll-target="#finding-a-spliced-motif">27 Finding a Spliced Motif</a></li>
  <li><a href="#transitions-and-tranversions" id="toc-transitions-and-tranversions" class="nav-link" data-scroll-target="#transitions-and-tranversions">28 Transitions and Tranversions</a></li>
  <li><a href="#completing-a-tree" id="toc-completing-a-tree" class="nav-link" data-scroll-target="#completing-a-tree">29 Completing a Tree</a></li>
  <li><a href="#longest-increase-subsequence" id="toc-longest-increase-subsequence" class="nav-link" data-scroll-target="#longest-increase-subsequence">30 Longest Increase Subsequence</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../rosalind_markdowns/1_10.html">Rosalind</a></li><li class="breadcrumb-item"><a href="../rosalind_markdowns/21_30.html">21-30</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">21-30</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="locating-restriction-sites" class="level3">
<h3 class="anchored" data-anchor-id="locating-restriction-sites">21 Locating Restriction Sites</h3>
<div id="c04c5c3a" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> utils <span class="im">import</span> DNA_complementary, transcription</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> restriction_sites(seq_str: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">        This function returns the postion and length of every reverse palindrome </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">        in the string having length between 4 and 12.</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">        - seq_str (str): A DNA string </span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">        - (str): all positions and lengths of reverse palindrome</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    len_lst <span class="op">=</span> [<span class="dv">12</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">4</span>]</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    answer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(seq_str)):</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(i)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> length <span class="kw">in</span> len_lst:</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">+</span> length <span class="op">&lt;=</span> <span class="bu">len</span>(seq_str):</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>                substr <span class="op">=</span> seq_str[i:i<span class="op">+</span>length]</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> check_palindrome(substr):</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>                    answer <span class="op">+=</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> <span class="bu">str</span>(length) <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> answer</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_palindrome(substr):</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(substr) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> DNA_complementary(substr[<span class="dv">0</span>]) <span class="op">==</span> substr[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(substr, substr[1:len(substr)-1])</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> check_palindrome(substr[<span class="dv">1</span>:<span class="bu">len</span>(substr)<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ba92e062" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"../data/rosalind/rosalind_repv.txt"</span>, <span class="st">"r"</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="st">""</span>.join(<span class="bu">file</span>.read().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(restriction_sites(text))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 4
13 4
22 8
23 6
24 4
39 4
57 4
62 4
63 4
132 8
133 6
134 4
141 4
142 4
175 4
195 8
196 6
197 4
200 4
206 4
218 4
220 6
221 8
221 4
222 6
223 4
225 4
228 4
234 4
236 8
237 6
238 4
261 6
262 4
271 4
274 4
307 4
318 4
341 4
419 4
442 6
443 4
461 12
462 10
463 8
464 6
465 4
491 4
520 4
534 4
544 6
545 4
548 6
549 4
609 4
611 4
631 6
632 4
639 6
640 4
652 4
654 4
703 10
704 8
705 6
706 4
715 6
716 4
731 10
732 8
733 6
733 4
734 4
735 4
758 4
761 6
762 4
790 4
800 4
801 4
822 8
823 6
824 4
846 6
847 4
852 6
853 4
858 4
886 4
901 4
929 4
</code></pre>
</div>
</div>
</section>
<section id="rna-splicing" class="level3">
<h3 class="anchored" data-anchor-id="rna-splicing">22 RNA Splicing</h3>
<div id="9bfd9441" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> utils <span class="im">import</span> transcription, translation</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> RNA_splicing(<span class="bu">file</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">        The function returns a protein string resulting from transcribing and </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">        translating the exons of a DNA string.</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">        - file: the file containing the string and its substrings (exons)</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">        - (str): the protein string</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    RNA_dict <span class="op">=</span> {}</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="bu">file</span>, <span class="st">"r"</span>) <span class="im">as</span> f:</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> f.read().split(<span class="st">"&gt;"</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        final_rosalind <span class="op">=</span> []</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> rosalind <span class="kw">in</span> text:</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> rosalind <span class="op">!=</span> <span class="st">""</span>:</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>                rosalind <span class="op">=</span> rosalind.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)[<span class="dv">1</span>:]</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>                final_rosalind.append(<span class="st">""</span>.join(rosalind))</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(final_rosalind)):</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>            RNA_dict[i] <span class="op">=</span> final_rosalind[i]</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>        pivot <span class="op">=</span> RNA_dict[<span class="dv">0</span>]</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(RNA_dict)):</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>            pattern <span class="op">=</span> re.<span class="bu">compile</span>(RNA_dict[j])</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>            m <span class="op">=</span> pattern.search(pivot)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> m <span class="op">!=</span> <span class="va">None</span>:</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>                pivot <span class="op">=</span> pivot[:m.start()] <span class="op">+</span> pivot[m.end():]</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>        RNA_seq <span class="op">=</span> transcription(pivot)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> translation(RNA_seq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6888032c" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"../data/results/answer_rosalind_splc.txt"</span>, <span class="st">"w"</span>) <span class="im">as</span> f:</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    f.write(RNA_splicing(<span class="st">"../data/rosalind/rosalind_splc.txt"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="enumerating-k-mers-lexicographically" class="level3">
<h3 class="anchored" data-anchor-id="enumerating-k-mers-lexicographically">23 Enumerating k-mers Lexicographically</h3>
<div id="1522a0e1" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> k_mers_enumerate(seq_str: List, k: <span class="bu">int</span>)<span class="op">-&gt;</span><span class="bu">str</span>:</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">        This function returns all strings of length n that can be formed from </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">        the alphabet given.</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">        - seq_str (List): a List of alphabet</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">        - k (int): the length of the wanted strings</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">        - (str): all the strings formed</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    cur <span class="op">=</span> <span class="st">""</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    cur <span class="op">=</span> recurse(<span class="st">""</span>, seq_str, k)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cur</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recurse(cur, lst, k):</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    answer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> k <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> cur <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(lst)):</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        nextChar <span class="op">=</span> lst[j]</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>        pr <span class="op">=</span> recurse(cur <span class="op">+</span> nextChar, lst, k <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>        answer <span class="op">+=</span> pr</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> answer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c7d86785" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(k_mers_enumerate([<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>], <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AA
AC
AG
AT
CA
CC
CG
CT
GA
GC
GG
GT
TA
TC
TG
TT
</code></pre>
</div>
</div>
</section>
<section id="genome-assembly-shortest-superstring" class="level3">
<h3 class="anchored" data-anchor-id="genome-assembly-shortest-superstring">24 Genome assembly shortest superstring</h3>
<div id="622d9446" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> overlap(seq_1, seq_2):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">        This function computes the overlapping maxima of two given strings</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    max_overlap <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    min_len <span class="op">=</span> <span class="bu">min</span>(<span class="bu">len</span>(seq_1), <span class="bu">len</span>(seq_2))</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, min_len <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> seq_1[<span class="op">-</span>i:] <span class="op">==</span> seq_2[:i]:</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">&gt;</span> max_overlap:</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                max_overlap <span class="op">=</span> i</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_overlap</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> genome_assembly(seqs)<span class="op">-&gt;</span><span class="bu">str</span>:</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">        This function uses greedy method to find and return the shortest s</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">        uperstring containing all the given strings.</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">        - seqs: the list of DNA sequences</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">        - (str): the superstring</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(seqs) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>        max_overlap <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>        best_pair <span class="op">=</span> (<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>        superstring <span class="op">=</span> <span class="st">""</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(seqs)):</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(seqs)):</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> i <span class="op">!=</span> j:</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>                    overlap_length <span class="op">=</span> overlap(seqs[i], seqs[j])</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> overlap_length <span class="op">&gt;</span> max_overlap:</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>                        max_overlap <span class="op">=</span> overlap_length</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>                        best_pair <span class="op">=</span> (i, j)</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>                        superstring <span class="op">=</span> seqs[i] <span class="op">+</span> seqs[j][overlap_length:] </span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>        i, j <span class="op">=</span> best_pair</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>        seqs[i] <span class="op">=</span> superstring</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>        seqs.pop(j)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seqs[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6b85827c" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"../data/rosalind/rosalind_superstring.txt"</span>, <span class="st">"r"</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="bu">file</span>.read().split(<span class="st">"&gt;"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    seqs <span class="op">=</span> []</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq <span class="kw">in</span> text[<span class="dv">1</span>:]:</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        seq <span class="op">=</span> seq.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)[<span class="dv">1</span>:]</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        seqs.append(<span class="st">""</span>.join(seq))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(genome_assembly(seqs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GGGTAGTCGCAGTTCTCGAGAGCGCCGGCACCCCGTGTGATTAGTTCCGCCCCGCGCTGCGCTCGAGAGAGTTGTCAGAAATAGAGCTGTGCAGCCCTGTTCCTTACAATTGTGTGCGCACGCGACTTGAAGTAGACCTTTCGCTGCTAACATGGCACGAAAGAAGGGTAATTGCAGCAGTGTATCGGACAGCAAGCGACCTTACTGGATGCAAGCGGGACCCCTGATAGAAGTTTCATGATGGGAACTTGGAGACGGAAGATCATTCTACGTTCGCAATGACAGGAAAAAGAATCGAACCGCTGAGCGCCTGCCTGGCTGTGTTCTGACAGGCGCACTACACCTGCGGTGTCATATCCTGCTTACTTCGGTTTCGCGCCGTTCTGAAAAGAATTCTAAGGGAATCCATCGTCCAGCTTGATGCTCCGATACAATAGCGCCCAAAAGTAGCTTAGCAGATCTCTCGTGCTTCTACATACTTTGAGAGGATGATGTTGTTCACCCCATCGCACAGTGATGTCGTATGTGCAGTCTTAGCGCGCGTTAGATCACGAGGTGGGTCAAGCAGAATATAATGGTACAGATGGGCTCAGCTTCAGTTTCGAGCATATGGCACGGATCTCGCACTCGGGGCGGTCCGTCCCACGGGTATTATCGTATAACACTGAGACTTTCCCTACCGAGAGAACAACTGGGAATCGACACTACTTGCGCCAAGGTAATTCATCACATAGTTACTGCGAACTCGAGGCGGTTGTCGGCAAAGGTTCACGAGAAAGCTCTGACTTCTTAGCAACGACCTGGCCGTACAGCCTGTAATAGAAGCGGTACTACTAACTAACACTTCGGGTCACATCAGGCACTTCACCACTAACGACCTAAACGTCATAGAATTTTCTGGATACGCCACCTCAACCGATCAAGGTATGCAGACAGAATGGCCAAAACAGGGCGCTGCGGACGTCGGGGGAAAGACTTACACTGATCGGCTCCTGCGTGCTTTCCGCTTACGACTTTGCAACACTCGACTTTGTAAAATACGCAGGTTTACGGATCTTTACGGTACTACAATGGATTTTTGAGGCAAAGACAGTACATATGAATGGGGAGCTTGCCGACCATCTATTGGAGCTACATTTGATGGTCGTACGCAATGGCCTGTCTTGAACGCTTGACGCTGATGGAGGACGACGCTCAGGGAGTTTGCTAGAAGGGGTCAACGCGACTCCAGAGAAGTTGGAACTATGGAACCCTTTTACCGTTCCCTGTAGCCGCAACGGAGCTTTATAGCCAGGCCGTTCAGCCTGGTCGATTTATGGGTGGAGCCCTTCGTTAGCGATCGCCACATACAGTACAGTATCAAGGATCATGTCACGGCTAATGGTCTGATAATCGGAGCTAGTAGTATCCAAGAGCGAAACGCGTACAAGACCCTGGTAGCAGTGCCTGACCTGTCCACTCAACGATGTTTGATAGGTTATGGTGGTGGGATGGCACGGCGTATAAACATGGCATAGTCACGTGTAGAGATGGAAACACTGCGGCGTACCCGACCACAGCGACCGAGCGCTGATGTGATCCTAGACCGTCCCATACCTGTGTTTGGCAGAACATTTGGGGTACTGAGACCCGTCCAACAGTTGCTCATCCATGTGATCGGTAAAGGCTTAGCCCATACGGTCACGGCTTAAGTATCAATGGTTTAAGTTTATGAAACTCAGGCTCGAGACTCTGTTTTTCATATATCTTCTGTTATCCTCTTGTTGGCGAGCATTCTCTTCTAGGAAACGAACAAAGAGAAACATCCACCTGGAGCATTCCTGAGGTGAGTTCGGGAAGCTCACGTCATAACGACGCGCTCTCAAAGCGATAGTAAAGCTAGTTTAAATTCCCATGCCTTAGTTAACCTTTGTCGTGTTCTGGTTATGTCGGGGAAAGAGTCAATGAATCACGGTTTGGATTGCTGTCGATCGTGATACGACTGCTAGGCGGTTAAGGGTTCTGGCAGATCGCTAAGTGCGCTTGAGTCTCGATGACAGTTTTTTAAGTTCACTCCGAACCGCTTCGGCTCTACCGATTCGAACCGTCAACCTCCTACGGGAGCTTAGGACCCCGTGGTCAGTCTTTGACTCAAGCTAATGGACCGAATCTAGTCGATCAGGCTCGCTCGATAGGTCGCTGCCCCTGACCACTGCGGAGGGACTTCGATAGGCCCTGACAGACCCGGAACGCCCAAGAGCGGATAAGTGCCTTGCGTGTCGGCTGGCAATAGTAGTGATTTAAAATATTCCAAGGCCTGCGCAAACCAGTGCTCATACACCCGGCGATAGCTGAGCCGGACCGCATACGTAGCCCTCTGTACAGCAAGGCTCCTCCCTCTGACCTTGCAGGTAAAAGACCGCCTACGTGGAAGTCATAGGCTCGACACGACCGAGAACCACGATTTGCGTACCGGCGTCCCGGTGGGGTCGAATGGTTGAGGGTCGATCCCCGCCCCTATTTGGAGTAGGCATTGTCCTAATACTGGAAGGTGGATGCCCAGACAAAGTACTAACACGCAACGCGGTTCTGCAGTTACTGCCCCCGTATTCAGCCAGCGTACTGCCCATATTGTTATGTGACGAGCTCGTCGGTCGTGCTGCTTGAATAGTCACTCGTCGATCGGCTGGGCTCTTAACTGGGGAATCGGTTCCACCGATTATACGAAAACTATTAAAGGCGGGTTAGATTTCCAGCTGATCTAGCCTGCTAGTTACAACCAACTCCTCAAAAACTAACGAACTGAACGATGGTTAGTACGTAAACGGTTAAGAGTTAGGGCTCGTCGGCGCTAATAGATGCACACATCATGGGCCACGCCCAGCCACTATACCCTCGAAAGGATAGGCGTCGGAGCTTCAGGTCGAAAAAATGGGCTACGTACTATGAGAGTTTCGGAATTGGAACGGAAGAAGCGCGCTATCTATTTGCGCCTCAGACTATCCAGGAATGATGAGCTACTTTAATTCGGTTAAAATCGTACGGAGCCATAGTCATATTAATCGGCCGTTCGAAACAAATGGGACAAAATACAGCTGCAGTGTGATCGAGAGGTAGATTCAGCGCCCCTCAGTGAAGTCGCGAAGGCACGATCGGACTAACAAGTTGTGCTGCCTCATGCTTTGTCATAGCCGATATTGCCCAACGAGGGATCTAAGGCTACAGACCTGGGGAATCGCCTGGCGACTGTTCAATTGCGTCTTTAGTGTGACGTCGACGTAAATGGAGATAGTATTTTTGCCAAGCCCTTCCGTGGCTCTCCCAATAAGATTAAAAACAGCAGGGCGTTTAGTGAATTCACTATGGGGAAGCGCCTCCGGTCTCAATTGTTTGAAAGCGCTCGGCCCTGGCATGCACTAGTCACGATGGCCGCCATTATCCACGCACCACTAAGGTCGAGCCTTAAGAGAGGGGAATGTCTAGATGGCCCTAGTATAACTGCTTTATTGCATTCTGAAAGCCCATTGTCTGTAGATTTAGCGCCAGCGATAGCTAAATAAACATCGTAGTGCGGGAATGCAATCCAGTTCAGCGTATGAACTTTAAATGAAGATGGACTTACAACACACACTGATGACGAAAGCCTGTAGAGTAAATAGAATGACAAAGTTAGTGCTATACGATCATTGCGGGGTTGGTGTGTCAATTCTGTGGCACCATCTATCGATGGTATTGGCTACTTTCGTAATCCTCGAGTACTGGGACAAACCAACAGAATCTCCTTCTCAACCCTAAGCAAACCCTACACGCGTTTCAGGGGGCCAACTGGAGTCGGCGGCGTAGTCCAGCCGACACCGCGCACCTTTGTGAGTACGCTAATTTGCTCTCATGGAAAGGGTCACTCTAACGCTCTGTGCAAAGCTTGCCCGTTGCATAAGAAGACCACCGTGTAGGTACTAGTCGAACTCACACTCACAAGTCAGAAAAGGGAACGCGGCGCGCACTTAGGGATCTCTCGCCGACAAATGGTGGTCATGGGCCTTGTGAAAATTTTTGTTCTTCAGAAGAGGATGGTTCTCGCCCGTTAGCCTTGGCTCACCAGTTCGTTTCTAGATAACATGATTTGGAGCGGTTTGTCTGAATTAAATCCTCCTTGGTCGAGATTGAACCTAGCGCTGGAACGAAGTGCATCGCGTCCATAACGCACGCACCGCTATGTACCGTTCTCAGCGGCATCACTAGGTGATAGACATTCGCTTTTAAGTCTTACGGCCTGACCGCTGAGGCTCTCAGGCGTGCGTCATAATCACGGTAGCTGCGAGCTTAACAATCGGGTCGTCCCAGGAATCGGTACTTCGTTATCGTCCACTCAGACCCTGCTTTTACACCGATTCGGATTCATACTTGTCTTTAGATAGCCACGTGAGGCTTCCTTCTGCCTTATTCGCCCTCTCCTTGTTGAGGCCTGTTCGCAAATTGCGATCATCACCTAACCCGTCCCCTTGTCCCCATACGCAGGCCACGGCGCAAATCACTTTGAGGGTTTTTCGTCGGAGAGTGATATGTCTTACAATGGGTGGGCCACCACCGAAAGAAAATACCTTACTCTATGGAACCATGTGCTAATCTTTCTCAACCGAATGCTCGTGGGGCGTAGCGGTTTGATCGTTACGCTTATGATACGGCACGTTTGCATACGTATTCTTGCTTAGGTATAGACTGCGTGCGCTCGATCGCGCACGAATGAAACTTCACCCCGAGCAATGCCTACTAATCTCTTGCGAAGTGTAAGACCAGCATCATCTTATGGTTTGTAGGGTTCGGAGGGCAGTCATACTATTGTCCTATGAATGAGGAGATTTGACAAGCCTTCCATTTAGTTACTGCGTCGGGCTGGGTTAAATGTCGCGCTTCCCAAAAAGAGGAAGTCGGGGATGTAGGCGGTTTAGCTGAGGGATATGAGGTGTAATAGATTGGCAGATCTTACTATGGCAGGGAAAAGTTGGGACATATTTGGAATCAAGTTTAGGTCTAGGTATGTTAGTCATACTCGGCTTCCATCTAACTAGAGCCATACATAGTCCATTTCTCGGGTGACTCGTCTTATTTCCCCAATTCTGTGCCCGGCAAGTGTTTCCGCTGTAGGAGTAATGCTGGTTCACGTTCAGGCCCTAGGCTGAAGCGTCTTCCGAAAGCCATCCGTCGACGAGTAATCTCCTGGGAGCGTGTTGGGGGCGCCTGCATGACTTTTTTACAGATCTCTCTCACGTTTAGGAAACGTATCGATCGGATCGAGTCTCCTGTCCTGAGCCAAAGCTACACTCTTACGATGGACGTATTCAATATCTGACATATCCTTGAGTAGCAATACATGGGAGTGTCAATTCGAGGCGTTCCTGGAAAACCGAGTTGCTCTTGAACGACGTCGGCGACGTCAGCAAGAAATAGCAAGTGCCGTCTGAATCGGAGTGTTCGCGCACAGTTCTGACACAACGTTGAATTTCAGTGACTCCAAACTCGCCTATGCTACGAGTTTGGAAGCAATCCGGATTGAATCATACTTCCTTCATGTCGCGCGGAATCGGGCTATACTGATTAGACACATCACCACGCCGACTAATAGGGGTCCACTGACTAGTTAAGGTGAGATGAGAGGTGAGATGCAGCCCGTGGACCAGTGGCTGTCTCATCCTGACTGTGTAGAACATTTAAAGAACCTCGGATAACCGGGAATGGACACAATAAGTTGAGACTAGCCCGCCGGGATATCACTCTAACGCGTCCCTCACCCAACAATGTAATATACACTTCACAATCAAAGATTTCGGAGCGCCACGGGCGTCACAGGGGCATGGGGATATACCGTTCGTGGACGTGCTAGTGTGTAGACGGCCATCCGTGTGTGCGGTGCGCGCATTAGAGATCCAGTTTGGGTAGCTTGAGATTATCACTGAACATCTTCAGTCCTTAGGCACCCATGTGAGGTATGAGTCTTCAGAGCATACGTATTCTGTGCTCACATGTTCCGCGGGGTCTAAAGCATTCTCAACTTTACGAGATCAAATTGCCTTTGTGGTCATTGGCCAGACCAAGTTCTACTTGGCTTCGTCAAGAGTTCCCGAAAAAACGCGATCCAAGCAGGACGAATTCAGGTATGAAGGAAACTGGTGGGCTACCATATCCCTAAGAGTATCCCTCGCCAGCCGGGCGATACTGTTGAAGTGTGATTTCAAGCAATACGGCGACGCAGAAATAATTAGAATCTGTTAGGGCTGGGGGGGATACTCCAAGTTCATATTGCATCAAGGAACAAGGCTAGCACCGATGGTATCCGTTTTGATTCTTCTGGCGGGTCAGATACGCGGTTTACGTATGGTCAATTGCCTCATGCATGGAGCCCAACGGTTATTGCACTCTCGCCGATACCCTCAGCATCCCTAGGATTGAAATACGCACGGAGCGTGAAACATTTGCAAAATCACCCCCTTAACCGTTAGCTGCCTATCAAGATTGCGAGCCTTAAGGGGCAGGTAAATTCCATGCGCGCGGTGACCCGGTCGCAAGTCCAAGCTCGGATCTACGGAGACTGTATGTGCAACACAATATTGATTCGAACGCGACGCTAAATTGTATACGCCACCCCCTTAACGCTAGGCGCTCGTACCTTATGATGCTCTGCACTTCTTCCTCACAAAACAAGTTATGTGAATGAGAGACCTTCTCATGAATCTGGAAAAACTTGTAAAGGTTCGCATATGCGTCGACTCACCCGAGAAGTGGGGATCAGTTGGAAATAGGTATGTCTTTAACCATATATGTACCTCCATTGCAGTCTGCTGCGCGGATTTATGCAGACATCCGCTAATCGGCACATTTCCGCGACAGCTATATGTAATCGTGGTTGATGCGTAAAACGCAGCGGAAGAATCGGATGATCTCACGTTTATATGTTAGGCCCGATTGTGGCGGATGAATGTCATCCCTTCTTGTCCTAAGAGATACAGTGCTCGCATGAAATTTACATGGTTTCCTGTCATTTTCCATATCGAATAATGCGAGCCTCTCGACTACAAATTACTAACGAGCGGGATGAGCGTCTCGTGTTTCATAGTCACTTCGATGGTGGTTATCGGCCGCCCCCGGAGGATTAGTGAGTAACTGAGATATTGTGCTTGGACATTGAGCAAATCTTTAAGGACGTAGTTGTCCGATCACGGGTGACGTGGGTGTCCTTTAGTCCTGACTTAGATGTTCTTGACTGCTTATTGATCTTCTACAGATCCGAAGCCATAGGGGGTTAGGTGTAACCGGCGGGGCTATCAGGACGCAGTACATTGATATGGATATCTTTGTCCCCGACGACTCGTGTCCTACCCGCATGGCTTGCCCGAATATGGTAACTCGGTACACAGCCCAAGGATAAATCTCATCCGCATCACAGACATGTAGTCGCCCGGGAGGTGGTCCTTGGTTCCGGGAAGTGAGACGGGCCGGGTTACGAGTGCTAATGCGGCTTGTGAAGTAGGTGTGTCATTCCTCCGGCATTATTCTAGCTGAGGAGTAGGATAGTCGTTTGGTGGGGAGATTTTTTTTGTTAACTCAGGGAGCTGAACAGCTGATGCCGTTCGCTACATACGCCGTTACCGCGAGGTTGTATCGGTGCCCCGGATCTGTGGGAAAGCTACTCTATCCCGGGCCCCCTTTAGGAGCTACAGCTGTTGTTGACTCTACAAATAGTAGCTTATCTTACTGCAGCATAAAACAGCTAATATTGCCAAAAGAGAGCTGCCCCAGGCGTTCGCCATGACCGTCGAAACTTACCCAATACCCTGTTTTAGCATTGGATAAGTCCAACACCCCAATTATCGAAAGGGATTACACTATGTAAGTAGGGACATATAACAGGTATGTTTCCTATGTTTCGGTATAGAGCGTTCCTCATCTCCCCTGACAATCGAACCGCGTCTAAAGTATCTGGGGTATGCGTTCTATCCTCCGTGTTTTCCCACCTTCAAGGTGTAAGATTAAAGAGGTTACTAGCAAACTATTTTGCACCACCTTGCCCAAGATAGTGACTTCCCGTAACATGCTAATGTTCCTGTCTTAGTCAAAGTTGGAGGTGGCCTGGTGTCAAAAGTATTCTCATTCATGAGCCCTAAAACGTCGTAACACCACTAGGCAATTGTCTCCTAACGAGTGTCTACGCAAGAACCTGCCACTAGGCCCCTCATGTCCTGCGAATCAAAAGTTACCAACCCAGGTTTGGAGTCGAAATAGGCCCCGCATTCCAATTGTTGCCGGCGTAGTCTGGGCAATTTATGTCGGTCACGTGTGTCGACTCTTTAGGACGAGATAAATCGTCGAAGACAGGGCATGTAAGCATACGTCTTATGGGAGGGTGTATATGGTTTATGCTAGTCCTTAGGGCAATCCCGGGCCGGCCCAAGTCAGCCCGTAGAAGGCGTGCTAGGTCGCGGTTACCCGTTCAAGCCATTCTACTGTAAGCCGCCGCACCGTTTCGTGGGTAGGGGAGACCCGAAATGGCACTGAGCTTCAGCAGTCCGTTCAGGTTTGACCGGGACCCCTTGCCGCTCGGCTTTTGGTCGACTGTTCGTGTGCCCATCAGACCGTACACGGCTGTAAGGAAAGGGGACTTTTCTACGCACAGGGAAAAACGAAGGGCATGTGTAGGTACACCCAGTATTTCTTGTAACCATGTTACGAACTCATGAAATGCCGACATAGCAGTCCAAGGTCTGATATGGTCCCACTTTAAAAAGGGTCAGTGATCTCAATGCTTTGCGTCACAGACGTTAGTATCCTTATCATGACGGGCGTGTGGAGTTTCGCCCAACATCGCGTATTTATAATGCCTTGGGTTGTGCGTTTAGCTAGAGGGGCCCTTATAACCTGGGTCCCCGGTTGCAACAGGAGAAAGATTACCCGAAAGGACTTAAGCTACGCCTGGACGATGAACACTCCGGGAATTACGTAGCCGACTGGGACTGTACCGTTACTGTTTCATAAATGGAATCGATATACAGATCGTTCCTAGTAACGGCCCCTAGTCCATTTAGAGTCCAGCCTTCCTACAAGCGGGCTCAGTACCCGATACAGCGGATAGAACCGTCCCGAGTGCACGTAACTCTCTGCCCGGAGGTTAGCCGCATCCGAGAAGCGTTTAGCTCCTTGCTTACCGAACCTAGACTCCGTTGACCAGCACTGAGTAGCGCATAACGCCTCGAGAAAGCTCCAAGTAGGTGAATTGAAGTCTACGTTGAGCTAATGGATTGGCGGCAAGCTACAGGTTTGATACGTTACAACTTTGGTGTTGACATAGGCAAGTCAAGTCCGACGGCATTTCCGAACCAGAACTTTCGAGCACTGTATTAAGGCATTCAATAAGTTGTAAGGGATCTCGGAAAAAGTGTTACGTTAGATCACTTGGACGGTGAACCATGAGATGCAGGCCTCGATCCCGGTTTTAAAACACTTCGAGTTCTGTGGGCCAATTGCCGGGGCCCACCCCGTCAGAAGGGATGGTCTTATTCTTTCATTAGAGCGAGGGAACTGTCGACTTCGAATGGTAAAGGTTTTGGAATTTATCATACGCAGCTATTACGCTTCTTCTCCCCGTGATCGCCACGATCTAAGCAGCGGCGGATGTAAACCGCGAAACCGGACTGATAACTAGCTGCCTACACGTCGGCGCTGCTCGCGATATGCGGAAGGGCTGTTCTCCTAAATTAGCGACGATACATCGTTGTGCAATTGGCTCCGCTTGGATACAACGGCTGAGTAGGGTGACTCTAATCCTAGCACGATAATTTCCTGGCTTGGACCTTTTTGTCACTTAACCGCACTATAGAGTTTTGGCCACCAACGTAGCTCGTGTATCGGGATAGCAATTCCGACGAGCGTCTCCACCTCCGGCAGGCGAGAGCGATTTGGAAACTAGGCTGGTTTATACCCCTGCAAATAATGGCCAGTAGCAAAAAACTCCGAAACGGGCAGAACTAACGTCCCAAATCCGGTTTACAATTAATCTCCAACGACGTTCCCTAAATAAACTCACTCTCGTTCAGTCTCCATATAGGGGTTGATACTTTTTGTCGGAAAGGACTCCTAGCCGTGACTAGGCATGGGAAAGGTGGGGCTGTGACCAGTACATTACTGACCTTTGCCTTGATTTAACGGGCCTTTTGGCCCCTAAAACAGCGACTCGCTAAAGGTTATTGGAATGCAAGACTTACACACTGTTCTCCATGGGCCGTGTTCGCACTACGTAAGTAGTGGTCTCATAACTCGGCCGATGTATCATAATCTTTCTCGACGGTCTACTGATTTGAGGGGTCCTCGGTTACTGCACGGCGTGGTGGCATTACTGACACGTTCTTAACCGAACGCGGAAGGTGCGATTAAAAGCAGGACGAAGATAATACCTTTGGGACCAGGCGTCGAGGTACGTTAATTCCCAGCTATTCGCGTTGGTCTTAAGTTGCGAGTTGTATGAATGAGAACTCTATGGCGGCGACAATTTCATATGCGAGCTAAACACCTCCCCTTACAAGCGAACGAGGGATAACTTCCAAGACAGATCGGCGGTGACTAGAGCTATGGACCCAAGGTACGCTTATAAGTCATTGCGGAATATCTCCCATCACACGGGCGAGCAGCGGAGAAGGGTTTATAGGACCCCCCGATCGGAAGTAACGCAGGAGTGACCAGTCACTCAAAAACTAATCTGGAGCCAATGTGTCCCTCCGCTAGCGTATGGATTGATAGTTTCCTGCTAATTAAGATCTATCAAAGGAAGACCTTTATCAAAAAATAAGGTGATTTGTTGCACGAAACATTGGATTGTGGCTGATGAGTCCAAAGATGAAGAATTTAACAACATTTACGACGGAAATCCCTTGGGTGGACCAAAGAATGCACATCCAGGTAACTCGATAAGCGACTATATACGGGTTTCGATGAGCGGACATTCCGGAAGGTGTCCAGTGTTGGAACGTTGCTTGAGTTTACAAAGCGCTCCATCAAGGCCAGTGTGTATGTTTACCCCACTTCCCACGCGGTGCTAAAACCACGTTAAGGTACGTGACTAGCTCCGGATCTATCACTAGAAAATAAAGGGGGTATCGTGGGAGTTAGACAGCCATCGGCCTATTCTGTATCCCGCTCAAGGTAGGCAAATCAGCATAATATACGCGTGTTATGCGGTGGTAAATGATGAAGTCACCTGAGAGTGATTCGGCACACCCGCCCTCGTGAAATGTCTCACGATGGTGGAGATTTCCAATGCATGGTCCAATGAGCTATATCGGGCCAACAGTAACTCGCGCTAAAACCCCCCAAACCCGTCGTATGCCAGTCGGTTACTATCAACTGGAATTCTGTTTTTTAGAGCGGTAGTCCTGGCCATGAAAACACTTTTGGGAGCTGACCTAACGTGTCAACCGTGGCCGGATTGGGGCCAGAAACAAAGCAGACTACCTAGTTGCATTATTTACCGCGAGATACAAGCGAGGTAGCGGCGACTCGATTTAATGGCAGCCTGTACAGATACACATCGGCATCTCTTTCCCCGCTGAGGTGAGCTGATCGCCGTACGACATAAACTAAAGGGCCACCTCTGCGGTATTAACATTATACTGCACGGCGTATACTGTATGTTGGTTCGATCCAAGCGTAAACATTCAACATCCGAATTAGGTCAGGGGTCCCACACACAACGGCAGAAGGTTAGCGCAGCGCGGGTCCTATGAAAGGACCAACTGGTTCCGTGCTAGGTGTGTCCGGGGTAATCTATGAGGCAGTGTGCTCACCTGAAGGTGCGTCAATCTGTCAGTCCGTGGTCGATCAACAGGTCCAATCAGCCTTGAAAGACACATGCATTTGGTCTCCTGTCATTCTGCTTACCTTACCTCTTGCCTAGTGTTGGGGCATGACGCCTGGAAACATACCTCTCCACGTTGTGTATAAAAGACCTCGCCATTCCTATTCTAACCCAGTTGGCTGGCTCATAGTGTCAAAGAAAATCCGAATCAAGGCGGCTTTATGCATCAGCAGTGGCACAGGCACTTCTGAAGTTGTGGGTAGGCTGCGGTCTCAGTTCTATTTTAATTTGCCGTACTAACTTTGTTACGTTACCTCGAGCACAATGGATGTACCGGATAGTTTGCGGCCCAGGTGCTAGGCGGACTTCAGCGCGGCTTCTACGGCAGTGGGTACGGAGAGTAGAGTATAGCCCGGGCATGGACTCCGAGTCGCCCAATGACGATGCTTCTCTTACCTCCGTCGTCAGCCACGTGATTAGTCCCTACCTTTGGTGTGGATGCGTCACCGTTCGCTGAGTCACGCGGAAGATGCGTTAAGCGGCTCCTCACATACAGTGGGCCAACCTTCAAGGACGAACGGCCCGCACTCCATACGGGAGGATATTAGCCACACTCCAAACGGCCTCATGCATATAGCATAGAGCCGCCACAAGCCATACCTAGAACATGAAATCCCAATACTGACAAATTTTCCGGTTGCGTACCAACAGGATGGCCGGATCCACAAACGGAGTCCGCGATTGACGGGGATTCGATTTCCGTGCATTTTAGACAAGGTGAGCGCGCCTCAGACCACAAGCAAGATGACCAGTCCATTAGCGCCAGACCTGCGGTACAGTCATATTTGGTCTATCGCAAGGGATCTCAAGGATAAGTGAGTTGCATTGTTTATTGCATTTTCTACCTGCCGGTAGATGCAATAGAATCGCCCTGCCGGTGGGCCCGTAGTCACGAAACTTCACTTTTGTGCCGTTCAGCTTCTGACGCACATTAGAACCCCAGGTACAGGCGACGCAGTCCATGTAACGAATTCAGCGAGGATCGGATCTGCTCAGTGCCCTTCTTTCGGGCTCGGTACAACGGAATTATCCGATGTACGATGGACAAGTGTTGTGACTGGGGTTCCACCGAAAATATAGGAATCGTGGTCACTACGCACTTGGTTTCGTGGAAATTTGCCCCTTTCACGGCGTTCCCCTCTTCAACCAGCGCGGGAGAAGGCACGTAAATTGAAAATCTGTTGAAGAAGCAAAGTCGGGAACTTTATCCGTAGTAAGCGAATGTTAATTTCCAGTCATCCGTAGATACGGTGCATGCAGAAGTATCAGAAAACACCTCGATAATACTCCCGAAAAGCGCATCAGGGCGCCGTTCCGAGGACTGCTTCAAGACATGTTACTTTGTCTCACTTGCGTTGGCAATAAGTCACCACCGCCGGTAATCGGTCTTTTGTGCCGAGGCTCGCTAGAAAGACCCTCGAGGGACCCCTATCAGAAAACAGGCGTTAAGACGCATCGTCTTTTAACGTTACACTATCAACGTACAGTTCTCTCGGCCCTGAATCGCCAGGTGTTAAAGAGTCTAGAATAGTCCGAAACACGCGACTCGCCTGCAGCTGTCGCTGGACGCTGGGGGGGATTGGTCACTTTGTAAGTGGATAACGTACCGGGATCGCAGGAGGGAACTCTCAGACCGGAAGCTCGCCGATACCGGCACTCGTAACGTAGATATTCAGGTGCTAGTTCTAAGGAAGGTAATCACCAGTGAGCGACATTACACTGGTGAGATTTAGCTTAGGGGCTACCTGGCGATAGTACGTGATATGGCTGGACCCAGAGACGTGTGACACTTTGCCTATATGCGACTATACCTTAGCAGTACCGGATAACCAAGGTTGCGTCAGCCGGCACATGAGATGGGTATCGCCATCGGCCGATTAGAATCAATATTACCCGCAGGAAACACGACGGCCCGTCGGCGGTAGGGTGACTGTGACGGGATGATATTCGTCTGAACTACGTCTTTGTGGTGTTCCCCGCTTTATGGTAACCAGCTCGCAACAATGAAGCAAGGATTACTAGGAACAATATATTACGGGAGCCGCCTCAATATAAAACTTTTGCATAACCCTTGACACGCAGTCCCCTTTAGCAGATTCTAGCGCACAGATGGAGTAGGGCGCGTAAGTCTCACCCTTGTAACCGGCAAGATGTTATTGCTCTGCTTATTGACGGGGCCTAGAATTTCACCTACTGTACTGTGGTTAGCCACGTTCCCTTGCAAGACTACCGCATCGGAAAGCTTACCCCTGCTAGTGAGGGGGCGGCATAGGCCGGAACAGATCCGGATCTTGTCGGGAAAAGAGGGGCCTGGAAGAAAGAGATCCAATAGTGCCAAAGCCTGCCCGTTGTAGTGGCGTGTGACGACTACTGCCACTTGGGCCTATCATGTCGCACCGTCCTCCTAAAAAGCGGGTGAGATTCTTTCCAGATACACGCGGAGATACGGCAACGGGTCTCGCGCGCGCATGAAGCAGCTTTACTAGACCCCACACTAGCCGCGGACGGCCGTCGTAGTAGAGTATGCTTCAACGGCGAATCAAGACAAAACCAAACGATGGTGCGGATCTGCCGAAGTGAGCGTACCCACGCAATGGCATATTGGGTATGTTGATTGGGTGGATTTACCGTCTTACCAATAAGGGGATTGCTAGACCTCTCTGGCTGAGGGGCATATGGTCCTCCGGTGTGTCCTTCTCCCATCGCACTACGGTTGCGGAGCGTCCTGCGTTCCACACCGTCTCCTAACGCGCCTAGTTTCACTTTCTTTTCACAAAACGGAACTGCGCAACGATGCTCGGCTGTATATTGAGTAGACTGACGACAGTACCGAGGAAAGGCTATGCTGCCCATTCCGGCCGACATTTCCGACTTGAATCATAATATACTCAGGTCGTCAGTCACGCTATGGATCTCGGGCGCCTTCGCACCTTGAAGCGCGAGTCGACAAGCTTATTGCGCTAGCCTCGAACCAGCTCAGTAGTTTAAATAAGGCTAGTATAGGATTGGCGTAGCCACAATTGAATAAGCTGCGCAGCATCTCCACGAGGTTGTTTGACAATGTTTTGCCTGGCTGTTCCTGAAAACGACTTTGAACTCTGTCCGTCACAACGTAGTAACACTTGTGCTTGTGGTATCCGCTCGGTGCCGAACCGACGTTTAACGTCCTTACCCGAACGTACGCGTTCCTGATTTGCAATATGCTTTCGCTCCCTTAGAAGCTAACCCTCACTCTGGTAGGAGTTAATCCCGGGGGTTTGGAATCTTCGTGAAAATAAACAAGTGGCAGTCAGAGTCAAATTGTCTGATGCTTGGTTGCACAGTGGTCTGAGAAGTCTGTAAAATATATCGCTGTCGGTATAGTTGACCGTAGCAGTAGGAAATCGACAAATGAGCCTTGAAATCGAGGGAACTTTTCGGACGCAAGAATTCTTCTGGCTGTGCGTTAACATTATACGGTCAAAGCGCATCTATCGTGTCTCTGGACTCTTAACTGCCCAGTTCAGCCCGCGCGTTTCCCCTTAACGTTGTGAAGCCTACGAACTTCGTAGCTAGCACCGGGTTCCCCGCTAACTTTCGTAGAATCTTTGCGTAGAAGATTCGAGAGGTGGGGAGCCTCGTACCCTGCCTTAGACGAATTTGTGCCTCTATGGGCGTTATTCAATAGTCCACCGACCGGTACTGCAAGCGGAATTTTCTCGTGCGACCACGCTGCTTTCAGGCACGGAACAGGTAGTTGTGGGTGACTCCACGCAGTGGCCGCGAGCGCCTCGTTCGAAATAAGGATACCGGTACAGATGGGTGCGCGCTTTGGGTGGTACTAATAAACTATTACCACTAGCGCGTCCCGCTTACCGTGAAGGTAGGTCAGTTTTTTAGATATGAAAGCGGGTGCGCTTCTACGACGCCGGGAGGAGCCCGTCGTCATTTGATTAAGCGAGAAGCGATCATGTGTCATCCCTTAAACCTATCATTATGGCACTCCGTTCAGTCAGCAGCGTCTTGAGTACGACAGACCACTAATGTCAGTATTTTCTCAGTTCACAGCAGGCGGTCGGATGCACGTTTACTTGGCCTCTACACCCGAGAACGTAAATTGTCATTCGAGCTGATCCTATCTCGGAACTAATTAAGAGATATCTAAAGGGTCCAGATTGATCGTTCGTTGTCGCTAGGACGCGTCATCAAGCACGGTGTTGTGCAAAGAAGCTCACAGGGTACAAAACTCGTTGGAATACGGAAAATCTAATACTCGATAACGTCGGTCGGCCCATAGCGCGAAGAGGTGTAGCATCCTGATTCGTTACGGATGACCGACGGAGTCCCGCCTGTTACATCTTCTCTATGCAACCTCTCAGATGGACCATTTCGTCCTTCAATTATTGTACTGGCGCGTTAACTGACTCGATCCGCCTCCGTACCCCGCTTGCGGCCAGCTTAGAGTTGACTTTGACAGGGGTGCGATTTCCCTGCCAAAAGTAATAACCATGAATTTGGCGCGCTCACCTTGAGCTCCGCAAGCTTGTCCGCGGCGCAGTCGGGAAGGAGGTCTTGGCAAGTAATTTCTTGGTGACGAACTCCTACGCAAGAAGTTACTCTTTCTATTTGAGGCGTTCGAAGTATGGTATTTCCCAGTTCCCACTACAACTACGAGAGCCTGTATAATCCAGTCATGTAGCCGTTTACTTCGCGTATGGAGCATAATCCTAATCAGGTCTTTAATCACCTTCATGGCGCAGCCCCCGCAACACTCGTTACAGGAGATGGCCTGTAGGTCTTGTAAATTTCTATATAGCCATTGACCGTCCCGAAGCAAACCAACCACGTCAAAAATTTCGGGCCACATCCCGATGCCGGCTGGCCGGAGTAGCCTAGGTAAAAAGGACGACCGCTGCTGAGGTCACTAAAGTCAGAAATAATATTGTGCAGGGTAATTGACGCATTCTCGTATTATTTCCATTATCAACGGACTCTACCTCGCTCCCGACCTAGGCTTTTGCCTATGCGACTATGGCGGAGCACTGGGCACTCATGGCGTACCGTGCCCTCCCTAACTCGCAAACGTTTGCGGTATGGTCACGACTATGACTGATTCAAAAATGGGTAGCGCGTGGTATTGTAGTAGAGGAAGGCAGTTAGATTGGGTCATGCCTATTAGATATTAGATTAATGACGGATCGTAGTTCAGGCGGTGCAGGGGAAGCTTATCCATGCGGGGTGAGATAGCACGACTCCGACGCCCCGGCCGCTAGCACCTCTTTTTATTTACGCTTACTACTCTGTTAGGATCAACTAGATTTCAACTACCAAGACCTCGGTCGCCATTAATTTTGTAACTTCTGCTATCTATCTTCCAACTTTCACTAACTATCGTGCGAAAGGATGGTCGATTTGTGCGATGGAAATTGGTCCAGCCGTATCTGCGGAGCCTGTATCGGGACTTTAGCGAGACTATTATCGAGTGATCAGGGCTTTCCCGCTATGAAAAAGTAACGTTTGCACTGCGCTGGTACGATATCGGCTAAGATTGCGTTGACAGTCATCGGAAGTCAAAAGGTGGCCTAATTACCGCTTTTTATTGCTGCATGTGTTTGTACCTATCTCCACCCGCCCAATTCTAGAACCAACGTAACAAAAGGTCAGGGGCAGAACTTCCGCTCCCTTCGACCAGTGGTCCCGACATGTCCAGGACGGTAAGCCCCAAGAATCCACGGAGCTATCAAATCCAGGGAAGGATCTGTGCTCACTGCTAGAGTTGTACATGCTACGAGCCGTGCGCCTCCAATTGTTTCTCCGTTGAGCCGAAGCTACTGGTATATACCCACCCATTAGTTTGTCTCTGACTACCAGTTACATGAATTCGACAAGCTACAGGTCAACCGACAGGTGCGGGTCAAACCGAACAGTACGACATACTGTACCCGGCTACCGATCGAGTGGGCCCGGGATGAGTTCCTCCGCCTGGCTGCGGTATGCCTTTATATCAAGAACCTAAATGTGCAAGTATATGACCACATATTCTTAGGTAGTTTTCCTGGGCTGAATCCCGCATTCAGCCCCGGCATCTGCAATTGAGCTAGGAGCCGGCCGCATGTCCTTTCCCTCGTCCGCCGGCCTTAGCGTAGCTTTTCGTAGCATCCACACCATAGCCCTGTGTTGTAACTTCGGGTCTGAGATCACCTTCTGTCCCCGAGAGGACACGTTCGGGAATCCATTCATAACTCGGGGAACCCGGCCACAATCATTCGATGAGGAGCCATGATAGGGTATGCGTACGCCGAGGAGGGTCAGCTGTTACTCCCGCGATCATAGGCCCGTATGTCGACCTTATTCTACACGAATGGCGTCAGCGCCGCGGCGCCCTAATCTAAGCTGATCCCGGTACAAGGATTCACATTAGCGACGTAGATCCGGAACGGAAACTTGTGGCAAGGCTTAAAATCCTGCACAACTCCGGGACCAGAGGCTAACTCATCAAAGGAATGACTGTAGATTAGCGAATATAACAAGCTAGCTCGTCCTCCAGGTCAACTTGGAGAGGGGGCGAGCACCGATATGTTAACCAGTGATCCGGCGCATTAATATCCGGATTCTGTAGGCATATTCCGGTGGGCTCCTCTATAACTTTTAATGTCATGGGGCATTTATAGCATGATCAAATTACAAGCCTAAATGAGACAGAACCCCCCTGAGGTAAACAGCATGCAAAGGCACAGCAGGGAACTACACTTAGTCCGCTGCCTGTGGGCATTATCGTCAATTTAAATGTGTTATCCGGGTTTTCTAAGACACTTAGCCGCCACGTGAGGCGTCCGGAGACAGCCTAACCGGTAAATGGTAACGCACACCTGATCGAATGCAATCTTCAGTCGACTTTTACCTCTAGGTGCTACGGGGATATGTTAACGTTGCTGATAGCCTAGCCTAAACTTGCGTGCGAGAGTGCGATCATCTGTTAAAGGGTTGGAGGATAGATAGTACGCTACGAAGTCGTTTGTTATTACATTGATGGATCAGTGTTGCGAAGCTTTGTTGATGACAACAAGATACGCGGCTTAAAACGATAAAATTTGTGCTCGGCCATGTGA</code></pre>
</div>
</div>
</section>
<section id="perfect-matchings" class="level3">
<h3 class="anchored" data-anchor-id="perfect-matchings">25 Perfect Matchings</h3>
<div id="674e59b8" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> perfect_matching(seq: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">        This function calculates the total possible number of perfect matchings </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">        of basepair edges in the bonding graph.</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">        - seq (str): the sequence to form the bonding graph</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">        - (int): the possible number of perfect matchings</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    A_counts <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    G_counts <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> char <span class="kw">in</span> seq:</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> char <span class="op">==</span> <span class="st">"A"</span>:</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>            A_counts <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> char <span class="op">==</span> <span class="st">"G"</span>:</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>            G_counts <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> math.factorial(A_counts) <span class="op">*</span> math.factorial(G_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="54e1c24c" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"../data/rosalind/rosalind_pmch.txt"</span>, <span class="st">"r"</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="bu">file</span>.read().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)[<span class="dv">1</span>:]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="st">""</span>.join(text)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(perfect_matching(text))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>778817392288148379660189696000000</code></pre>
</div>
</div>
</section>
<section id="introduction-to-random-strings" class="level3">
<h3 class="anchored" data-anchor-id="introduction-to-random-strings">26 Introduction to Random Strings</h3>
<div id="d491a72b" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> random_strings(seq, prob_seqs) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">        This function computes the possibility of forming the given DNA sequence</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">        using an array of GC-content probability.</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">        - seq (str): the DNA string to form</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">        - prob_seqs (List): the list of probability</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">        - (str): a string of calculated common logarithm </span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    answer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> prob <span class="kw">in</span> prob_seqs:</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>        prob <span class="op">=</span> <span class="bu">float</span>(prob)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>        gc_prob <span class="op">=</span> prob<span class="op">/</span><span class="dv">2</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        qa_prob <span class="op">=</span> (<span class="dv">1</span><span class="op">-</span>prob)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        multi <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> char <span class="kw">in</span> seq:</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">==</span> <span class="st">"G"</span> <span class="kw">or</span> char <span class="op">==</span> <span class="st">"C"</span>:</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>                multi <span class="op">*=</span> gc_prob</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>                multi <span class="op">*=</span> qa_prob</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>        common_prob <span class="op">=</span> <span class="bu">round</span>(math.log(multi, <span class="dv">10</span>), <span class="dv">3</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>        answer <span class="op">+=</span> <span class="bu">str</span>(common_prob) <span class="op">+</span> <span class="st">" "</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> answer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3742ebfd" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(random_strings(<span class="st">"ACGATACAA"</span> , [<span class="fl">0.129</span>, <span class="fl">0.287</span>, <span class="fl">0.423</span>, <span class="fl">0.476</span>, <span class="fl">0.641</span>, <span class="fl">0.742</span>, <span class="fl">0.783</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-5.737 -5.217 -5.263 -5.36 -5.958 -6.628 -7.009 </code></pre>
</div>
</div>
</section>
<section id="finding-a-spliced-motif" class="level3">
<h3 class="anchored" data-anchor-id="finding-a-spliced-motif">27 Finding a Spliced Motif</h3>
<div id="3c1a27a3" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> spliced_motif(s_seq, t_seq)<span class="op">-&gt;</span><span class="bu">str</span>:</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">        This function returns a collection of indices of subsequence locations</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">        - s_seq (str): the DNA string</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">        - t_seq (str): the subsequence to be found</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">        - (str): a string of subsequence locations</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    locations <span class="op">=</span> <span class="st">""</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    prev <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> t_seq:</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        pattern <span class="op">=</span> re.<span class="bu">compile</span>(i)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        m <span class="op">=</span> pattern.search(s_seq)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        locations <span class="op">+=</span> <span class="bu">str</span>(prev <span class="op">+</span> m.start()) <span class="op">+</span> <span class="st">" "</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>        prev <span class="op">+=</span> m.start() <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>        s_seq <span class="op">=</span> s_seq[m.start() <span class="op">+</span> <span class="dv">1</span>:]</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> locations</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="bc3b4290" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"../data/rosalind/rosalind_sseq.txt"</span>, <span class="st">"r"</span>) <span class="im">as</span> f:</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> f.read().split(<span class="st">"&gt;"</span>)[<span class="dv">1</span>:]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    seq_1 <span class="op">=</span> <span class="st">""</span>.join(text[<span class="dv">0</span>].split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)[<span class="dv">1</span>:])</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    seq_2 <span class="op">=</span> <span class="st">""</span>.join(text[<span class="op">-</span><span class="dv">1</span>].split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)[<span class="dv">1</span>:])</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(spliced_motif(seq_1, seq_2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 3 4 11 22 29 32 34 35 41 53 54 56 59 61 66 68 77 79 86 92 102 120 121 122 127 129 135 139 143 149 163 174 175 176 180 185 187 188 189 192 197 202 206 207 215 217 219 222 223 226 227 230 231 239 248 252 256 257 265 266 272 274 282 288 289 292 </code></pre>
</div>
</div>
</section>
<section id="transitions-and-tranversions" class="level3">
<h3 class="anchored" data-anchor-id="transitions-and-tranversions">28 Transitions and Tranversions</h3>
<div id="ac7767b1" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trans(seq_1, seq_2)<span class="op">-&gt;</span><span class="bu">float</span>:</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">        This function calculates the transition/transversion ratio </span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">        - seq_1, seq_2 (str): the 2 sequences to calculate transition/transversion</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">        - (float): R(s1/s2) ratio</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    transition_r <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    transversion_r <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> {<span class="st">"A"</span>: <span class="st">"purine"</span>, <span class="st">"G"</span> : <span class="st">"purine"</span>, <span class="st">"T"</span> : <span class="st">"pyrimidine"</span>, <span class="st">"C"</span> : <span class="st">"pyrimidine"</span>}</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, j <span class="kw">in</span> <span class="bu">zip</span>(seq_1, seq_2):</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> nucleotides[i] <span class="op">==</span> nucleotides[j] <span class="kw">and</span> i <span class="op">!=</span> j:</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>            transition_r <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> nucleotides[i] <span class="op">!=</span> nucleotides[j] <span class="kw">and</span> i <span class="op">!=</span> j:</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>            transversion_r <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_r<span class="op">/</span>transversion_r</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="273c613c" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"../data/rosalind/rosalind_tran.txt"</span>, <span class="st">"r"</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="bu">file</span>.read().split(<span class="st">"&gt;"</span>)[<span class="dv">1</span>:]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    seq_1 <span class="op">=</span> <span class="st">""</span>.join(text[<span class="dv">0</span>].split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)[<span class="dv">1</span>:])</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    seq_2 <span class="op">=</span> <span class="st">""</span>.join(text[<span class="op">-</span><span class="dv">1</span>].split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)[<span class="dv">1</span>:])</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(trans(seq_1, seq_2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.797979797979798</code></pre>
</div>
</div>
</section>
<section id="completing-a-tree" class="level3">
<h3 class="anchored" data-anchor-id="completing-a-tree">29 Completing a Tree</h3>
<div id="dc4de4f9" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tree_build(num_nodes: <span class="bu">int</span>, adj_ls: List) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">        This function returns minimum number of edges that can be added to the </span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">        graph to produce a tree.</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">        - num_nodes (int): the number of tree nodes</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co">        - adj_ls: the list of currently adjacent nodes</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co">        - (int): the missing edges to complete the tree</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    present_nodes <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    dis_graphs <span class="op">=</span> []</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Stop when you can not add another graphs to the current disgraphs</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(adj_ls) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>        dis_gr <span class="op">=</span> adj_ls[<span class="dv">0</span>]</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>        isAdded <span class="op">=</span> <span class="va">True</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(adj_ls) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>            dis_graphs.append(dis_gr)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="bu">len</span>(adj_ls) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>            adj_ls <span class="op">=</span> adj_ls[<span class="dv">1</span>:]</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> isAdded:</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(dis_gr)</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>            addition <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(adj_ls)):</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>                ls <span class="op">=</span> adj_ls[i]</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>                intersectionality <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(dis_gr).intersection(ls))</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">len</span>(intersectionality) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>                    dis_gr <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(dis_gr).union(<span class="bu">set</span>(ls)))</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>                    adj_ls.pop(i)</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>                    addition <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> addition <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>                isAdded <span class="op">=</span> <span class="va">False</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>        dis_graphs.append(dis_gr)</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">"../data/results/results_tree.txt"</span>, <span class="st">"w"</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> each <span class="kw">in</span> dis_graphs:</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>            <span class="bu">file</span>.write(<span class="bu">str</span>(each) <span class="op">+</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> graphs <span class="kw">in</span> dis_graphs:</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>        present_nodes <span class="op">+=</span> <span class="bu">len</span>(graphs)</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">len</span>(dis_graphs) <span class="op">-</span> <span class="dv">1</span> <span class="op">+</span> (num_nodes <span class="op">-</span> present_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7139e168" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"../data/rosalind/rosalind_tree.txt"</span>, <span class="st">"r"</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="bu">file</span>.read().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    num_nodes <span class="op">=</span> <span class="bu">int</span>(text[<span class="dv">0</span>])</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    adj_ls <span class="op">=</span> [<span class="bu">list</span>(text.split(<span class="st">" "</span>)) <span class="cf">for</span> text <span class="kw">in</span> text[<span class="dv">1</span>:]]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(tree_build(num_nodes, adj_ls))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>23</code></pre>
</div>
</div>
</section>
<section id="longest-increase-subsequence" class="level3">
<h3 class="anchored" data-anchor-id="longest-increase-subsequence">30 Longest Increase Subsequence</h3>
<div id="a0693758" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> copy</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> subsequence(seq: List):</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">        This function returns the longest increasing subsequence and the longest</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co">        decreasing subsequence.</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co">        - seq (List): the sequences of numbers</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co">        - (str): the longest increasing/decreasing subsequence</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co">.</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    seq_length <span class="op">=</span> <span class="bu">len</span>(seq)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    increase <span class="op">=</span> []</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    decrease <span class="op">=</span> []</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Add 1 to all arrays</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(seq_length):</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>        increase.append(<span class="dv">1</span>)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>        decrease.append(<span class="dv">1</span>)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>        seq[i] <span class="op">=</span> <span class="bu">int</span>(seq[i])</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Construct an array to store longest subsequence increasingly and decreasingly</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, seq_length):</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i):</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> seq[j] <span class="op">&lt;</span> seq[i] <span class="kw">and</span> increase[i] <span class="op">&lt;=</span> increase[j]:</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>                increase[i] <span class="op">=</span> increase[j] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>    reverse_seq <span class="op">=</span> seq</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, seq_length):</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i):</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> reverse_seq[i] <span class="op">&lt;</span> reverse_seq[j] <span class="kw">and</span> decrease[i] <span class="op">&lt;=</span> decrease[j]:</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>                decrease[i] <span class="op">=</span> decrease[j] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Iterate through the array to find the maximum value of sequence</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>    max_seq <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>    index_seq <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>    max_reverse_seq <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>    index_reverse_seq <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(seq_length):</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> increase[i] <span class="op">&gt;</span> max_seq:</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>            max_seq <span class="op">=</span> increase[i]</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>            index_seq <span class="op">=</span> i</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> decrease[i] <span class="op">&gt;</span> max_reverse_seq:</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>            max_reverse_seq <span class="op">=</span> decrease[i]</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>            index_reverse_seq <span class="op">=</span> i</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Backtracking from the maximum value max, if meets max-1, add to list array[max-1]</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>    <span class="co">## and assign max = max - 1, continue to track from backward </span></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>    longest_increase_seq <span class="op">=</span> [seq[index_seq]]</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>    longest_decrease_seq <span class="op">=</span> [reverse_seq[index_reverse_seq]]</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(index_seq <span class="op">-</span> <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> max_seq <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> increase[i] <span class="op">==</span> max_seq <span class="op">-</span> <span class="dv">1</span> <span class="kw">and</span> longest_increase_seq[<span class="op">-</span><span class="dv">1</span>] <span class="op">&gt;</span> seq[i]:</span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>            longest_increase_seq.append(seq[i])</span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>            max_seq <span class="op">=</span> max_seq <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(index_reverse_seq <span class="op">-</span> <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> max_reverse_seq <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> decrease[i] <span class="op">==</span> max_reverse_seq <span class="op">-</span> <span class="dv">1</span> <span class="kw">and</span> longest_decrease_seq[<span class="op">-</span><span class="dv">1</span>] <span class="op">&lt;</span> reverse_seq[i]:</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>            longest_decrease_seq.append(reverse_seq[i])</span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>            max_reverse_seq <span class="op">=</span> max_reverse_seq <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">"../data/results/results_lgis.txt"</span>, <span class="st">"w"</span>) <span class="im">as</span> f:</span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>        inc <span class="op">=</span> <span class="st">""</span></span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>        dec <span class="op">=</span> <span class="st">""</span></span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> item <span class="kw">in</span> longest_increase_seq[::<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>            inc <span class="op">+=</span> <span class="bu">str</span>(item) <span class="op">+</span> <span class="st">" "</span></span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> item <span class="kw">in</span> longest_decrease_seq[::<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>            dec <span class="op">+=</span> <span class="bu">str</span>(item) <span class="op">+</span> <span class="st">" "</span></span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(inc)</span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>        f.write(inc)</span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>        f.write(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(dec)</span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>        f.write(dec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="5a7dce46" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"../data/rosalind/rosalind_lgis.txt"</span>, <span class="st">"r"</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="bu">file</span>.read().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)[<span class="dv">1</span>]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> text.split(<span class="st">" "</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    subsequence(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>85 164 237 352 472 521 577 608 641 661 852 931 1011 1074 1111 1128 1281 1301 1390 1408 1458 1641 1722 1749 1800 1946 1995 1999 2014 2076 2106 2115 2152 2194 2224 2305 2324 2343 2369 2379 2384 2471 2493 2525 2621 2651 2669 2670 2733 2790 2795 2839 2890 2945 3190 3210 3455 3457 3469 3470 3513 3649 3702 3739 3750 3856 3876 4035 4051 4056 4103 4115 4132 4140 4156 4326 4538 4570 4580 4616 4666 4669 4876 4885 4888 4935 5016 5261 5377 5389 5415 5464 5541 5583 5596 5902 5917 5929 5939 5941 6011 6089 6173 6186 6226 6244 6254 6319 6326 6489 6511 6607 6708 6843 6862 6891 6937 6964 7004 7144 7145 7240 7245 7383 7387 7429 7459 7624 7665 7675 7726 7791 7804 7844 7850 7865 7870 7888 7893 7964 7999 8048 8073 8087 8092 8099 8125 8135 8199 8221 8237 8330 8349 8395 8593 8602 8693 8731 8764 8772 8900 8939 9051 9142 9147 9198 9231 9248 9261 9323 9327 9333 9385 9389 9421 9428 9517 9565 9582 9674 9707 9775 9816 


9811 9792 9779 9760 9717 9681 9678 9675 9479 9450 9395 9357 9342 9293 9262 9210 9160 9153 9101 8969 8956 8945 8863 8856 8819 8806 8770 8761 8677 8609 8499 8405 8391 8380 8294 8270 8191 8137 8105 8100 8074 8071 7983 7969 7954 7936 7856 7811 7790 7744 7731 7718 7685 7372 7290 7212 7184 7152 7140 7075 7057 7043 7005 7000 6866 6781 6712 6682 6433 6375 6358 6297 6271 6145 5995 5992 5927 5882 5795 5766 5751 5659 5656 5596 5549 5542 5462 5457 5422 5412 5393 5313 5179 5099 5057 5020 4988 4906 4856 4774 4714 4560 4533 4506 4418 4410 4382 4258 4247 4208 4128 4086 4014 3992 3969 3896 3806 3661 3614 3514 3360 3358 3335 3284 3149 3095 2976 2949 2887 2832 2753 2741 2732 2722 2632 2599 2590 2517 2512 2338 2296 2291 2253 2208 2188 2164 2021 1922 1911 1903 1857 1851 1849 1723 1714 1646 1610 1585 1582 1540 1514 1497 1483 1428 1379 1325 1207 1136 1135 1052 995 948 805 751 685 520 466 429 408 396 361 247 234 227 215 139 114 61 </code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>